
\documentclass[11pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[french]{babel}
\usepackage[top=3cm, bottom=2cm, left=2cm, right=2cm]{geometry}
\usepackage{stmaryrd}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{mathrsfs}
\usepackage{amsthm}
\usepackage{layout}
\usepackage{fancyhdr}
\usepackage{comment}

\newtheorem*{thm}{Théorème}
\newtheorem{ex}{Exercice}
\newtheorem*{nota}{Notation}
\newtheorem*{rem}{Remarque}
\newtheorem*{rem2}{Remarques}
\newtheorem{de2}{Définition}
\newtheorem{pro2}[de2]{Propriété}
\newtheorem{thm2}[de2]{Théorème}

\setlength{\parindent}{0cm}
\setlength{\parskip}{1ex plus 0.5ex minus 0.2ex}
\newcommand{\hsp}{\hspace{20pt}}
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

\title{}

\date{}
\begin{document}


\pagestyle{fancy}

\fancyhead{}
 \fancyfoot{}

 \lhead{ 2025/2026 \\  L3 Mathématiques
}
\chead{\textbf{ Calcul formel}\\} 
 \rhead{  Université de Lorraine \\}

\newcommand{\lb}{\llbracket}
\newcommand{\rb}{\rrbracket}

%\newcommand{\md}[3]{#1 \equiv #2 \! \! \! \! \! \pmod {#3} }
\newcommand{\nmd}[3]{#1 \not \equiv #2 \! \! \! \! \!  \pmod #3 }
\newcommand{\mda}[3]{#1 \equiv #2 \! \!  \pmod #3 }
\newcommand{\nmda}[3]{#1 \not \equiv #2 \! \! \pmod #3 }
\newcommand{\mo}[2]{#1 \! \! \! \! \! \pmod #2 }
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\md}{\mathrm{\ mod\ }}


\thispagestyle{fancy}

\begin{center}
%    \HRule \\[0.6cm]
    { \huge \bfseries
    Feuille de TD n$^{\boldsymbol{\circ}}$5
     \\ [0cm] }
    \HRule \\[0.5cm]
\end{center}



\


\begin{ex}\label{calculs_symboles_legendre}\
Calculer les symboles de Legendre suivants :
$$  \left( \frac{7}{17} \right); \qquad \left( \frac{28}{13} \right); \qquad \left( \frac{10}{83} \right)  ; \qquad \left( \frac{665}{97} \right)       .$$

On pourra utiliser les propriétés suivantes : pour tous $a,b\in \Z$, $(\frac{ab}{p})=(\frac{a}{p})(\frac{b}{p})$, la loi de réciprocité quadratique, $(\frac{2}{p})=(-1)^{(p^2-1)/8}$ et $(\frac{-1}{p})=(-1)^{(p-1)/2}$. 
 \end{ex}
 
 


\begin{ex}\label{nombres_Poulets} $($Nombres de Poulet$)$\

On appelle nombre de Poulet un nombre composé $n$ tel que $n$ divise $2^n-2$. 
\begin{itemize}
\item[$1.$] Soit $p\in\mathbb{P}$. Montrer que $p$ divise $2^p-2$.

\item[$2.$] Déterminer l'ordre de $2$ dans les groupes (multiplicatifs) $(\mathbb{Z}/11 \mathbb{Z})^{\times}$, $(\mathbb{Z}/31 \mathbb{Z})^{\times}$ et $(\Z/341\Z)^\times$ (on pourra faire un calcul direct ou bien remarquer que $341=11\times 33$ et utiliser le théorème chinois). 

\item[$3.$] Soit $n$ un nombre pseudo-premier de base $2$ (c'est à dire que $n$ est composé et $2^{n-1}\equiv 1[n]$). \begin{itemize}

\item[$a)$] Montrer que $n$ est un nombre de Poulet.

\item[$b)$] Réciproquement, soit $n$ un nombre de Poulet. À quelle condition $n$ est-il un nombre pseudo-premier de base $2$ ?

\item [$c)$] Montrer que $341$ est un nombre de Poulet.
\end{itemize}

\item[$4.$] Soient $n$ un nombre de Poulet et $m=2^n-1$.  \begin{itemize}
\item[$a)$] Soient $a,b \in \mathbb{N}^*$. Montrer que si $a \mid b$, alors $2^a-1 \mid 2^b-1$ (on pourra considérer $\sum_{i=0}^{k-1} x^i$, pour $k\in \N^*$ et $x\in \Z\setminus\{1\}$).
\item[$d)$] En déduire que $m$ est un nombre de Poulet.

\end{itemize}


\item[$5.$] Les nombres de Poulet sont-ils en nombre fini ou infini ?
\item[$6.$] Montrer qu'un nombre de Mersenne $M_p=2^p-1$, où $p$ est premier et $M_p$ composé, est un nombre de Poulet.
\item[$7.$] Montrer qu'un nombre de Fermat $F_n=2^{2^n}+1  $ composé est un nombre de Poulet (on pourra commencer par montrer que si $k\in\N$, alors $2^{2^k}+1$ divise $2^{2^{k+1}}-1$).
\end{itemize}
\end{ex}





\begin{ex}\label{bases_pseudo-premiers}\

\begin{itemize}
\item[$1.$] Pour quelles bases $15$ est-il pseudo-premier ? (i.e pour quels $a\in\Z$ a-t-on $a^{15-1}\equiv 1[15]$  ?)
\item[$2.$] Montrer que $105 (=3\times 5 \times 7)$ est pseudo-premier de base $13$ mais n'est pas pseudo-premier de base $2$.
\item[$3.$] Décrire une méthode permettant de déterminer, pour $n\in\N_{\geq 2}$, l'ensemble des bases pour lesquelles $n$ est pseudo-premier de base $n$ (on supposera que la décomposition de $n$ en produit de facteurs premiers s'écrit $n=p_1^{\alpha_1}\ldots p_k^{\alpha_k}$, avec $p_i^{\alpha_i}$ «~petit~» pour tout $i\in \llbracket 1,k\rrbracket$). 
\end{itemize}
\end{ex}




\begin{ex}\label{nombres_pseudo-premiers}\

Soit $a\in \N_{\geq 2}$. On va montrer ici qu'il y a une infinité de nombres pseudo-premiers de base $a$, c'est à dire de nombres $n$ tels que $a^{n-1}\equiv 1[n]$. Pour cela, soit $p$ un nombre premier impair vérifiant $p \nmid a(a^2-1)$. Posons $n=(a^{2p}-1)/(a^2-1)$.
\begin{itemize}
\item[$1.$] Montrer que $n$ est un entier composé (on pourra considérer $\sum_{i=0}^{p-1} a^i$ et $\sum_{i=0}^{p-1}(-a)^i$).
\item[$2.$] Montrer que $ a^{2p} \equiv 1 [n]$.
\item[$3.$] Calculer $(a^2-1)(n-1)$ puis montrer que $p \mid (n-1)$.
\item[$4.$] Montrer que $2 \mid (n-1)$ (on pourra distinguer les cas $a$ pair et $a$ impair).
\item[$5.$] En déduire que $n$ est pseudo-premier de base $a$. Conclure.
\end{itemize}
\end{ex}

\begin{comment}
\begin{ex}\label{exRacines_carrées}
\begin{enumerate}
\item Soit $p\in \mathbb{P}$. On se place dans $\Z/p\Z$. Soit $\overline{x}\in (\Z/p\Z)^*$. Montrer que $(\overline{x})^{(p-1)/2}\in \{\overline{-1},\overline{1}\}$ et que $\overline{x}^{(p-1)/2}=\overline{1}$ si et seulement si $\overline{x}$ est un carré (autrement dit, $\overline{x}^{(p-1)/2}=\overline{\left(\frac{x}{p}\right)}$).

\item  Supposons que $p\equiv 3[4]$. Est-ce que $\overline{-1}$ est un carré de $\Z/p\Z$ ? Montrer que si $\overline{x}\in \Z/p\Z$,  $(\overline{x}^{(p+1)/4})^2=\left(\frac{x}{p}\right) \overline{x}$. En déduire que  $\overline{x}$ est un carré si et seulement si $\overline{\left(\frac{x}{p}\right)}=\overline{1}$, ainsi que l'ensemble des racines de $\overline{x}$, lorsque c'est un carré.

\item Déterminer les racines de $\overline{8}$ dans $\Z/23\Z$ ainsi que les racines de $\overline{19}$ dans $\Z/31\Z$.

\item Déterminer les racines de $\overline{33}$ et de $\overline{37}$ dans $\Z/44\Z$ (on pourra utiliser le théorème chinois).


\item Soient $p\in\mathbb{P}$, $\alpha\in \N^*$ et $x\in \Z$. Montrer que si $\gamma\in \Z$ est tel que $\gamma[p^{\alpha+1}]$ est une racine carrée  de $x[p^{\alpha+1}]$, alors $\gamma[p^\alpha]$ est une racine carrée de $x[p^\alpha]$.


\item Déterminer l'ensemble des racines de $\overline{8}$ dans $\Z/23^2\Z$ et de $\overline{19}$ dans $\Z/31^2\Z$ (pour déterminer une racine  $\overline{\gamma}$ de $\overline{x}$ dans $\Z/p^2\Z$, avec $p\in \mathbb{P}_{\geq 3}$ alors que l'on connaît une racine  $\overline{\gamma_0}$ de $\overline{x}$ dans $\Z/p\Z$, on peut chercher $\gamma$ sous la forme $\gamma_0+pk$, où $k\in \Z$, calculer $(\gamma_0+pk)^2$ puis essayer d'en déduire une valeur de $k$).

\item Soient $p\in \mathbb{P}_{\geq 3}$, $\alpha\in \N^*$ et $x\in \Z$ tels que $x\wedge p=1$. On suppose que $x[p^\alpha]$ admet une racine $\gamma[p^\alpha]$ (où $\gamma\in \Z$). Montrer que $x[p^{\alpha+1}]$ admet une unique racine $\gamma'[p^{\alpha+1}]$ telle que $\gamma\equiv \gamma'[p^\alpha]$ (on pourra chercher $\gamma'$ sous la forme $\gamma+p^{\alpha}k$, où $k\in \Z$).

\end{enumerate}
\end{ex}
\end{comment}


\begin{ex}\label{eq_second_degré}\
Soit $p$ un nombre premier impair.
\begin{itemize}
\item[$1.$] Montrer que le nombre de racines carrées d'un entier $\alpha \in \mathbb{Z}$ dans $\mathbb{Z}/p\mathbb{Z}$ $($i.e. le nombre d'éléments $x \in \mathbb{Z}/p\mathbb{Z}$ tels que $x^2\equiv \alpha [p])$ est $1+ \left( \frac{\alpha}{p} \right)$ (on pourra utiliser, après l'avoir démontrée l'identité remarquable $x^2-y^2=(x-y)(x+y)$, pour tous $x,y\in \Z/p\Z$ dans $\Z/p\Z$).
\item[$2.$] Soient $a,b,c\in \mathbb{Z}$ vérifiant $p \nmid a$. Montrer que l'équation (E) : $ax^2+bx+c=0$ possède $1+ \left( \frac{\Delta}{p} \right)$ solutions dans $\mathbb{Z}/p\mathbb{Z}$ où $\Delta=b^2-4ac$ (on pourra se ramener à l'équation $x^2+\frac{b}{a}x+\frac{c}{a}=0$, et calculer $(x+\frac{b}{2a})^2)$.

\item[$3.$] Déterminer le nombre de solutions dans $\mathbb{Z}/83\mathbb{Z}$ des équations suivantes:
\begin{itemize}
\item[$a)$] $x^2+1=0$;
\item[$b)$] $x^2+x+1=0$;
\item[$c)$] $x^2-4x+13=0$;
\item[$d)$] $x^2+x+21=0$;
\item[$e)$] $x^2+9x-3=0$.
\end{itemize}
\end{itemize}
\end{ex}

\begin{comment}

\begin{ex}\label{exNombres_racines}
Soit $p\in \mathbb{P}_{\geq 3}$.

\begin{enumerate}
\item Soit $k\in \N^*$. Soit $x\in \Z$ tel que $x\wedge p=1$. On suppose que $x$ admet une racine modulo $p^k$. Montrer que $\overline{x}$ admet exactement deux racines dans $\Z/p^k\Z$ (on pourra montrer que $(a-\gamma)\wedge (a+\gamma)\mid 2\gamma$, si $\overline{a},\overline{\gamma}$  sont des racines de $\overline{x}$).

\item Déterminer les racines de $\overline{9}$ dans $\Z/27\Z$. Combien-y-en a-t-il ?

\item Soit $x\in \llbracket 1,p^k-1\rrbracket$. Montrer que l'on peut écrire $x=p^\beta q$, où $\beta\in \llbracket 0,k-1\rrbracket$ et $q\in \llbracket 0, p^{k-\beta}-1\rrbracket$ vérifie $x\wedge q =1$. 

\item On admet que $x$ admet une racine carrée modulo $p^k$ si et seulement si $\beta$ est pair et $\left(\frac{q}{p}\right)=1$.  Soient $\alpha=\beta/2$ et  $\gamma\in \llbracket 0,p^{k}\rrbracket$ une racine de $x$ modulo $p^k$.  Montrer que $p^{\alpha}$ divise $\gamma$.

\item On écrit $\gamma=p^{\alpha}\gamma'$, où $\gamma'\in \llbracket 0, p^{k-\alpha}-1\rrbracket$. Trouver une équation modulaire vérifiée par $\gamma'$ puis en déduire le nombre de racines de $x$ modulo $p^k$. En déduire que $x$ admet $2p^\alpha$ racines modulo $p^k$.

\item Déterminer l'ensemble des racines de $0$ modulo $p^k$. 
\end{enumerate}
\end{ex}
\end{comment}

\begin{comment}
Exercice~\ref{nombres_Poulets}
1. On a $2^2-2=2$, donc $2$ divise $2^2-2$.

 Supposons $p\geq 3$. Alors $2\not\equiv 0[p]$. Par le petit théorème de Fermat, $2^{p-1}\equiv 1[p]$, donc $2^p\equiv 2[p]$, donc $p$ divise $2^p-2$.



2. Dans $(\Z/11\Z)^\times$ : $11$ est premier, donc $\varphi(11)=10$ et l'ordre de $\overline{2}$ divise $10$. On a $\overline{2}^2=\overline{4}$, $\overline{2^3}=\overline{8}=\overline{-3}$, $\overline{2^5}=\overline{2^3}.\overline{2^2}=\overline{-1}\neq \overline{1}$. On en déduit que $\overline{2}$ est d'ordre $10$.

Dans $(\Z/31\Z)^\times$ : on a $\overline{2}^5=\overline{32}=\overline{1}$, donc $\overline{2}$ est d'ordre $5$ dans $(\Z/31\Z)^\times$.

Soit $\phi:\Z/341\Z\rightarrow \Z/11\Z\times \Z/31\Z$ l'isomorphisme chinois. Alors comme $\phi$ est un isomorphisme, l'ordre de $\overline{2}$ dans $(\Z/341\Z)^\times$ est égal à l'ordre de $(\overline{2},\overline{2})$ dans $(\Z/11\Z)^\times \times (\Z/31\Z)^\times$ (car pour tout $x\in \Z/341\Z$ et $k\in\Z$, $x^k=\overline{1}$ si et seulement si $\phi(x^k)=\phi(\overline{1})=(\overline{1},\overline{1})$). Par la question 3 de l'exercice 3 du TD3, $\overline{2}$ est d'ordre $5\vee 10)=10$ dans $(\Z/341\Z)^\times$.



3.a) Dans $\Z/n\Z$, $\overline{2}^{n-1}=\overline{1}$, donc $n$ divise $2^{n-1}-1$ qui divise $2(2^{n-1}-1)=2^{n}-2$, donc $n$ est un nombre de Poulet.

b) Soit $n$ un nombre pseudo-premier de base $2$. Alors $2^{n-1}\equiv 1[n]$ donc $n$ divise  $2^{n-1}-1$ donc $n$ est impair. Soit $n$ un nombre impair qui est un nombre de Poulet. Alors $n$ divise $2^n-2$ et comme $2$ est premier avec $n$, $n$ divise $(2^n-2)/2=2^{n-1}-1$. Donc $n$ est un nombre pseudo-premier de base $2$.

c) Dans $\Z/341\Z$, on a  $\overline{2}^{340}=(\overline{2}^{10})^{34}=\overline{1}$, par la question 1), donc $341$ est un nombre de Poulet.

c) On a $\sum_{i=0}^{k-1} x^i=\frac{x^k-1}{x-1}\in \Z$, donc $x-1$ divise $x^k-1$. En prenant $k=\frac{b}{a}$ et $x=2^a$, on obtient que $2^a-1$ divise $2^b-1$.

d) On a $n$ divise $2^n-2$ donc par b), $2^n-1$ divise $2^{2^n-2}-1$ qui divise $2.(2^{2^n-2}-1)=2^{2^n-1}-2=2^m-2$. De plus, par la question b), pour tout diviseur $d$ de $n$, $2^d-1$ divise $2^{n}-1=m$. Comme $n$ est composé, $m$ est composé, donc $m$ est un nombre de Poulet.

5) Posons  $n_0=341$ définissons la suite $(n_k)_{k\in \N}$ par récurrence en posant $n_{k+1}=2^{n_k}-1$, pour $k\in\N$. Alors $(n_k)$ est une suite strictement croissante de nombres de Poulet, d'où l'existence d'une infinité de nombres de Poulet.


6) Par le théorème de Fermat, $p$ divise $2^{p-1}-1$, donc $p$ divise $2^p-2$, donc $M_p$ est un nombre de Poulet.

7)  Soit $n'\in \N$. Alors $2^{n'+1}-(n'+1)=2^{n'}-n'+(2^{n'+1}-2^{n'})-1=2^{n'}-n'+2^{n'}-1>2^{n'}-n'$. Par  récurrence, on en déduit que $2^{n'}-n'\geq 2^0-0=1$, donc $2^{n'}-n'>0$. On a donc $2^n\geq n+1$. Soit $k\in \N$. Alors $2^{2^{k}}+1|(2^{2^k}-1)(2^{2^k}+1)=2^{2.2^{k}}-1=2^{2^{k+1}}-1$. Par récurrence on en déduit que si $k,\ell\in \N$ sont tels que $k<\ell$, alors $2^{2^k}+1$ divise $2^{2^\ell}-1$. On applique ceci à $k=n$ et $\ell=2^n$. On a donc $2^{2^n}+1|2^{2^{2^n}}-1|2.(2^{2^{2^n}}-1)=2^{F_n}-2$, donc $F_n$ est un nombre de Poulet.



Exercice~\ref{nombres_pseudo-premiers}

1) On a $\sum_{i=0}^{p-1} a^i=\frac{a^p-1}{a-1}\in \Z$ et $\sum_{i=0}^{p-1} (-a)^i=\frac{(-a)^{p}-1}{(-a)-1}=\frac{a^p+1}{a+1}\in \Z$ (car $p$ est impair). On a donc $\frac{a^{2p}-1}{a^2-1}=\frac{a^p-1}{a-1}\frac{a^p+1}{a+1}\in \Z$. De plus, $p>1$, donc $\frac{a^p-1}{a-1}>1$ et $\frac{a^p+1}{a+1}>1$, donc $\frac{a^{2p}-1}{a^2-1}$ est composé.

2) On a  $n|a^{2p}-1$ donc $a^{2p}\equiv 1[n]$.

3) On a $(a^2-1)(n-1)=(a^2-1)n-(a^2-1)=a^{2p}-1-(a^2-1)=a^{2p}-a^2=a^2(a^{2p-2}-1)$. Dans $\Z/p\Z$, on a $\overline{a}^{p-1}=\overline{1}$ (par le théorème de Fermat, car $p$ ne divise pas $a$), donc $(\overline{a}^{p-1})^2=\overline{1}$, donc $\overline{(a^2-1)(n-1)}=\overline{0}$, donc $p|(a^2-1)(n-1)$. De plus, par hypothèse sur $p$, on a $\overline{a(a^2-1)}\neq \overline{0}$, donc $\overline{a^2-1}\neq 0$, donc $\overline{n-1}=\overline{0}$ (car $\Z/p\Z$ est un corps). Autrement dit, $p$ divise $n-1$.

4) Supposons $a$ pair. Alors $\sum_{i=0}^{p-1} a^i=\frac{a^p-1}{a-1}$ et $\sum_{i=0}^{p-1} (-a)^i=\frac{(-a)^{p}-1}{(-a)-a}=\frac{a^p+1}{a+1}$ sont impairs donc  $n=\frac{a^{2p}-1}{a^2-1}=\frac{a^p-1}{a-1}\frac{a^p+1}{a+1}$ est impair donc $n-1$ est pair.

Supposons $a$ impair. Alors $\sum_{i=0}^{p-1} a^i=\frac{a^p-1}{a-1}\equiv \sum_{i=0}^{p-1} 1 [2]\equiv p[2]$ donc $\frac{a^p-1}{a-1}$ est impair. De même $\frac{a^p+1}{a+1}$ est impair donc $n$ est  impair donc $n-1$ est pair. Dans tous les cas, $n-1$ est pair.

5) Par les questions 3) et 4), et comme $2$ et $p$ sont premiers entre eux,  $2p$ divise $n-1$ (par le lemme de Gauss).  Écrivons $n-1=2pk$, où $k\in \Z$. Alors $a^{n-1}\equiv (a^{2p})^k [n]\equiv 1^k [n]\equiv 1[n]$, donc $n$ est un nombre pseudo-premier de base $a$. Comme il existe une infinité de nombre premiers, on en déduit qu'il existe une infinité de nombre pseudo-premiers de base $a$.


Exercice~\ref{bases_pseudo-premiers}

\
1) Soit $\phi:\Z/15\Z\rightarrow \Z/3\Z\times \Z/5\Z$ l'isomorphisme chinois. Soit $a\in \Z$ tel que $a^{14}\equiv 1[15]$. Alors $\phi(\overline{a})^{14}=(\overline{1},\overline{1})$, c'est à dire $(a\mathrm{\ mod\ } 3)^{14}=1\mathrm{\ mod\ }3$ et $(a\mathrm{\ mod\ }5)^{14}=1\mathrm{\ mod\ }5$. On a $(0\mathrm{\ mod\ }3)^{14}=0\mathrm{\ mod\ }3\neq 1\mathrm{\ mod\ }3$, $(1\mathrm{\ mod\ }3)^{14}=1\mathrm{\ mod\ }3$ et $(-1\mathrm{\ mod\ }3)^{14}=1\mathrm{\ mod\ } 3$. 

On a $\varphi(5)=4$, donc l'ordre de tout élément de $(\Z/5\Z)^\times$ divise $4$. Ainsi, si $x\in \Z\setminus 5\Z$, $(x\mathrm{\ mod\ }5)^{14}=(x\mathrm{\ mod\ }5)^{3.4+2}=(x\mathrm{\ mod\ }5)^2$. On cherche donc les $x\mathrm{\ mod\ }5\in (\Z/5\Z)^\times$ tels que $(x\mathrm{\ mod\ }5)^2=1\mathrm{\ mod\ }5$. On obtient $1\mathrm{\ mod\ }5$ et $4\mathrm{\ mod\ }5$. Donc \[\{\overline{x}\in \Z/15\Z|\ \overline{x}^{14}=\overline{1}\}=\{\phi^{-1}\big((\overline{1},\overline{1})\big),\phi^{-1}\big((\overline{1},\overline{4})\big),\phi^{-1}\big((\overline{2},\overline{1})\big),\phi^{-1}\big((\overline{2},\overline{4})\big)\}.\] On a $-3.3+2.5=1$, donc $\phi(\overline{10})=(\overline{1},\overline{0})$ et $\phi(\overline{-9})=(\overline{0},\overline{1})$ donc $\phi^{-1}\big((\overline{1},\overline{0})\big)=\overline{10}$ et $\phi^{-1}\big((\overline{0},\overline{1}\big)=\overline{-9}=\overline{6}$. On a donc $\{\phi^{-1}\big((\overline{1},\overline{1})\big),\phi^{-1}\big((\overline{1},\overline{4})\big),\phi^{-1}\big((\overline{2},\overline{1})\big),\phi^{-1}\big((\overline{2},\overline{4})\big)\}=\{\overline{1},\overline{4},\overline{11},\overline{14}\}$. Le nombre $15$ est donc pseudo-premier de base $a$ si et seulement si $a\mathrm{\ mod\ }15\in \{1\mathrm{\ mod\ }15,4\mathrm{\ mod\ }15, 11\mathrm{\ mod\ }15, 14\mathrm{\ mod\ }15\}$.


2) On a $(13\md 3)^{104}=(1\md 3)^{104}=1\md 3$, $(13\md 5)^{104}=(3\md 5)^{104}=((3\md 5))^2)^{52}=(-1\md 5)^{52}=1\md 5$ et $(13\md 7)^{104}=(-1\md 7)^{104}=1\md 104$. Soit $\phi:\Z/105\Z\rightarrow \Z/3\Z\times \Z/5\Z\times \Z/7\Z$ l'isomorphisme chinois. Alors $\phi(\overline{13})^{104}=(13\md 3,13\md 5,13\md 7)^{104}=(1\md 3,1 \md 5,1 \md 7)$ donc $\overline{13}^{104}=\overline{1}$ dans $\Z/105\Z$, donc $105$ est pseudo-premier de base $13$.

On a $\varphi(7)=6$, donc l'ordre de $\overline{2}$ dans $(\Z/7Z)^\times$ divise $6$, donc $\overline{2}^{104}=\overline{2}^{6.17+2}=\overline{1}^{17}.\overline{2}^{2}=\overline{4}\neq \overline{1}$. On a donc $\phi(\overline{2})^{104}=\big((2\md 3)^{104}, (2\md 5)^{104},4\md 7)\neq (1\md 3, 1\md 5, 1\md 7)$ donc $(2\md 105)^{104}\neq 1\md  105$, donc $105$ n'est pas pseudo-premier de base $2$.

3) Écrivons la décomposition de $n$ en produit de facteurs premiers $n=p_1^{\alpha_1}\ldots p_k^{\alpha_k}$, où les $p_i$ sont des nombres premiers distincts et $\alpha_1,\ldots,\alpha_k\in \N^*$. Soit $\phi:\Z/n\Z\rightarrow \Z/p_1^{\alpha_1}\Z\times \ldots \times \Z/p_k^{\alpha_k}\Z$ l'isomorphisme chinois. On doit trouver l'ensemble $E=\{a\in \Z|a^{n-1}\equiv 1[n]\}$. On a $\phi(E)=\{(x_1,\ldots,x_k)\in \Z/n\Z\rightarrow \Z/p_1^{\alpha_1}\Z\times \ldots \times \Z/p_k^{\alpha_k}\Z|(x_1^{n-1},\ldots,x_k^{n-1})=(\overline{1},\ldots,\overline{1})\}$. Pour déterminer $E$, on peut donc déterminer $E_i:=\{x\in \Z/p_i^{\alpha_i}\Z|\ x^{n-1}=\overline{1}\}$ pour tout $i\in \llbracket 1,k\rrbracket$ puis déterminer $\phi^{-1}(E_1\times \ldots \times E_k)$. Soient $i\in\llbracket 1,k\rrbracket$ et $x\in \Z/p_i^{\alpha_i}\Z$. Alors si $x\in E_i$, $x$ est inversible dans $\Z/p_i^{\alpha_i}\Z$ (car $x.x^{n-2}=\overline{1}$).  Par le théorème d'Euler, $x^{\varphi(p_i^{\alpha_i})}=\overline{1}$.  De plus, $\varphi(p_i^{\alpha_i})=p_i^{\alpha_i}(1-\frac{1}{p_i})<p_i^{\alpha_i}<n-1$. On peut donc déterminer le reste  $r_i$ de la division euclidienne de $n-1$ par $\varphi(p_i^{\alpha_i})$. Alors $E_i=\{x\in (\Z/p_i^{\alpha_i}\Z)^\times |x^{r_i}=\overline{1}\}$. On peut alors déterminer $E_i$ en essayant tous les éléments de $\Z/p_i^{\alpha_i}\Z$.



Exercice~\ref{calculs_symboles_legendre}

D'après la loi de réciprocité quadratique, $\left( \frac{7}{17} \right)=(-1)^{\frac{7-1}{2}.\frac{17-1}{2}}(\frac{17}{7})=(\frac{17}{7})$. Par définition, $(\frac{17}{7})=(\frac{17\md 7}{7})=(\frac{3}{7})$. Par la loi de réciprocité quadratique, $(\frac{3}{7})=(-1)^{\frac{7-1}{2}.\frac{3-1}{2}}(\frac{7}{3})=-(\frac{7}{3})=-(\frac{7\md 3}{3})=-(\frac{1}{3})=-1$.

\bigskip

On a $(\frac{28}{13})=(\frac{28\md 13}{13})=(\frac{15}{13})=(\frac{2}{13})=(-1)^{(169-1)/8}=(-1)^{21}=-1$.

\bigskip


On a $(\frac{10}{83})=(\frac{2}{83}).(\frac{5}{83})$. On a $(\frac{2}{83})=(-1)^{\frac{83^2-1}{8}}$. On s'intéresse à la parité de $(83^2-1)/8$. Soit $x\in\Z$ tel que $\frac{x-1}{8}\in \Z$. Alors $\frac{x-1}{8}$ est pair ssi $\frac{x-1}{8}=2k$ pour $k\in \Z$ ssi $x=16k+1$, pour $k\in \Z$. Le nombre  $\frac{x-1}{8}$ est impair ssi $\frac{x-1}{8}=2k+1$ pour $k\in\Z$ ssi $x-1=16k+8$ ssi $x=16k+9$, pour $k\in \Z$.

 On a $83=5.16+3\equiv 3[16]$ donc $(83)^2\equiv 9 [16]$ donc $(83^2-1)/8$ est impair donc $(\frac{2}{83})=-1$. On a $(\frac{5}{83})=(-1)^{(5-1)/2.(83-1)/2}.(\frac{83}{5})=(\frac{83}{5})=(\frac{83\md 5}{5})=(\frac{3}{5})$. On a $(\frac{3}{5})=(-1)^{(3-1)/2.(5-1)/2}(\frac{5}{3})=(\frac{2}{3})=(-1)^{(9-1)/8}=1$. On a donc $(\frac{10}{83})=1$.


\bigskip

On a $(\frac{665}{97})=(\frac{133}{97})(\frac{5}{97})=(\frac{133\md 97}{97})(\frac{5}{97})$. De plus, $(\frac{133\md 97}{97})=(\frac{36}{97})=(\frac{6}{97})^2=1$, car $(\frac{6}{97})\in \{-1,1\}$. On a $(\frac{5}{97})=(-1)^{(5-1)/2.(97-1)/2}(\frac{97}{5})=(\frac{97}{5})=(\frac{2}{5})=(-1)^{(5^2-1)/8}=(-1)$. On a donc $(\frac{665}{97})=-1$.

Exercice~\ref{algorithme_legendre}

\begin{tabular}{ll}
\textbf{Algorithme} & Legendre($a,p$)\\
           & si $a=1$\\
                      & \ \ \ {\rm | }renvoyer $1$,\\
           & si $a=2$\\
                      & \ \ \ {\rm | }renvoyer $(-1)^{(p^2-1)/8}$,\\
           & si $a\geq p$ ou $a\leq 0$,\\
                     & \ \ \ {\rm | }renvoyer Legendre$(a\md p,p)$,\\           
           & si $a\geq 3$ et $a\leq p-1$\\
                      & \ \ \ {\rm | }$X\leftarrow$ factorisation$(a)$ \\
                      & \ \ \ {\rm | }$P\leftarrow X[0]$ \\     
                      & \ \ \ {\rm | }$A\leftarrow X[1]$ \\
                      & \ \ \ {\rm | }renvoyer $\prod_{i\in \llbracket 0,\mathrm{len}(P)\rrbracket|A[i]\%2==1}\text{Legendre}(P[i],p)$,\\
           & si $a\geq 3$ et Is\_prime(a)==True\\
                      & \ \ \ {\rm | }renvoyer $(-1)^{\frac{a-1}{2}\frac{p-1}{2}}\text{Legendre}(p,a)$\\           
\end{tabular}

Cet algorithme termine  car les $P[i]$ sont strictement inférieurs à $p$ à chaque étape, on se ramène donc à des calculs de $(\frac{a'}{p'})$ avec $a'\in \N$ et $p'<p$.

Cet algorithme renvoie la bonne valeur par les propriétés rappelées à l'exercice 4.



Exercice~\ref{eq_second_degré}

1) Si $\alpha=0$, alors la seule racine carrée de $\overline{0}$ dans $\Z/p\Z$ est $\overline{0}$, car $\Z/p\Z$ est intègre. De plus $1+(\frac{0}{p})=1$, donc la formule donnée est valable pour $\alpha=0$.

Supposons que $\alpha$ n'admette pas de racine carrée dans $\Z/p\Z$. Alors $\alpha$ n'est pas un carré dans $\Z/p\Z$, donc $(\frac{\alpha}{p})=-1$ et $1+(\frac{\alpha}{p})=0$.

Soient $A$ un anneau commutatif et  $x,y\in A$. Alors $(x-y)(x+y)=x^2-xy+yx-y^2=x^2-y^2$.

Supposons que $\overline{\alpha}$ est un carré non nul de $\Z/p\Z$. Alors il existe $\overline{\beta}\in \Z/p\Z$ tel que $\overline{\beta}^2=\overline{\alpha}$. Soit $x\in \Z/p\Z$. Alors $x^2=\overline{\alpha}$ si et seulement si $x^2-\overline{\beta}^2=0$. De plus, $(x-\overline{\beta})(x+\overline{\beta})=x^2-\overline{\beta}^2$ donc $x^2-\overline{\beta}^2=0$ si et seulement si $(x-\overline{\beta})(x+\overline{\beta})=\overline{0}$ (car $\Z/p\Z$ est intègre) si et seulement si $x\in \{-\overline{\beta},\overline{\beta}\}$. Alors $\overline{\alpha}$ admet exactement $2=1+(\frac{\alpha}{p})$ racines carrées dans $\Z/p\Z$.

2) Comme $a$ est inversible $x$ est solution de (E) si et seulement si $x^2+\frac{b}{a}x+\frac{c}{a}=0$. On a $(x+\frac{b}{2a})^2=x^2+2\frac{b}{2a}x+\frac{b^2}{4a^2}=x^2+\frac{b}{a}x+\frac{b^2}{4a^2}$. Soit $x\in \Z/p\Z$. Alors $x$ est solution de (E) si et seulement si $x^2+\frac{b}{a}x+\frac{c}{a}=0$ si et seulement si $(x+\frac{b}{2a})^2-\frac{b^2}{4a^2}+\frac{c}{a}=(x+\frac{b}{2a})^2+\frac{4ac-b^2}{4a^2}=0$ si et seulement si $(x+\frac{b}{2a})^2=\frac{b^2-4ac}{4a^2}$. Cette équation admet une solution si et seulement si $\frac{b^2-4ac}{4a^2}$ est un carré. Soit $y\in \Z/p\Z$. Alors $y^2=\frac{b^2-4ac}{4a^2}$ si et seulement si $(2ay)^2=b^2-4ac$ donc $\frac{b^2-4ac}{4a^2}$ est un carré si et seulement si $b^2-4ac$ est un carré. Si $b^2-4ac$ est un carré, les racines carrées de $\frac{b^2-4ac}{4a^2}$ sont exactement les $\frac{y}{2a}$ tels que $y$ est une racine carrée de $b^2-4ac$, d'où le résultat.

3) On a $\Delta_a=-4$, donc $(\frac{\Delta_a}{83})=(\frac{-4}{83})=(\frac{-1}{83})(\frac{4}{83})=(-1)^{41}.(\frac{2}{83})^2=-1$ $\leadsto$ $0$ solution.

On a $\Delta_b=-3$, donc $(\frac{\Delta_b}{83})=(\frac{-1}{83})(\frac{3}{83})=-(\frac{3}{83})$. On a $(\frac{3}{83})=(-1)^{(3-1)/2.(83-1)/2}(\frac{83}{3})=-(\frac{83}{3})=-(\frac{2}{3})=-(-1)^{(9-1)/8}=1$. On a donc $(\frac{\Delta_b}{83})=-1$ $\leadsto$ $0$ solution.


On a $\Delta_c=16-4.13=-36$ donc $(\frac{\Delta_b}{83})=(\frac{-1}{83})(\frac{6}{83})^2=(\frac{-1}{83})=-1$ $\leadsto 0$ solution.

On  a $\Delta_d=1-4.21=-83$ donc $(\frac{\Delta_d}{83})=(\frac{-83}{83})=0$ $\leadsto$ 1 solution.

On a $\Delta_e=9^2-4.3=69$ donc $(\frac{\Delta_e}{83})=(\frac{69}{83})=(\frac{23}{83})(\frac{3}{83})=(\frac{23}{83})$ (car on a déjà calculé $(\frac{3}{83})=1$). On  a $(\frac{23}{83})=(-1)^{11.41}(\frac{83}{23})=(\frac{14}{23})=(\frac{2}{23})(\frac{7}{23})$. On a $23\equiv 7[16]$ donc $23^2\equiv 49[16]\equiv 1[16]$ donc $(-1)^{(23^2-1)/8}=1$. On a $(\frac{7}{23})=(\frac{23}{7})=(\frac{2}{7})=(-1)^{48/8}=1$. On a donc $(\frac{\Delta_e}{83})=1$ donc il y a $2$ solutions.





Exercice~\ref{securite_RSA}

1) On a $(a^{2^{j}t})^2=a^{2.2^jt}=a^{2^{j+1}t}=\overline{1}$.

2) Soit $a\in Y$. Soit $E(a)=\{j'\in \llbracket 1,s\rrbracket| a^{2^{j'}t}=\overline{1}\}$. Écrivons $ed-1=k\varphi$, avec $k\in\N^*$. Alors par le petit théorème de Fermat, $a^{k\varphi}=\overline{1}$, donc $a^{2^st}=\overline{1}$, donc $s\in E(a)$. Soit $j=\min E(a)$. Alors par définition, $a\in Y_j$. Par la question 1), $E(a)=\llbracket j,s\rrbracket$. On en déduit que si $a\in Y_{j'}$ pour $j'\in \llbracket 1,s\rrbracket$, alors $j'=j$. On a donc $Y=\bigsqcup_{j=1}^s Y_j$. Soit $a\in Z$. Par définition de $Z$, on a $Z=\bigcup_{j=1}^s Z_j$. De plus, si $j\in \llbracket 1,s\rrbracket$, on a $Z_j\subset Y_j$, donc l'union est disjointe : $Z=\bigsqcup_{j=1}^s Z_j$.


3)a) Comme $Z_j\subset Y_j$, on a $Z_j\subsetneq Y_j$. Soit $a\in Y_j\setminus Z_j$, alors $a^{2^{j-1}t}\in \{\overline{-1},\overline{1}\}$ et $a^{2^{j-1}t}\neq \overline{1}$, donc $a^{2^{j-1}t}=\overline{-1}$.

b) Soit $\phi:\Z/n\Z\rightarrow \Z/p\Z\times \Z/q\Z$ l'isomorphisme chinois. Écrivons $\phi(a)=(a_p,a_q)$. Alors $(a_p)^{2^j t}=-1\md p$ et $(a_q)^{2^jt}=-1\md q$. On a $(a_p)^{2^jtt_p}=(-1\md p)^{t_p}=-1\md p$. Par le petit théorème chinois, $(a^{tt_p})^{2^{k_p}}=(a^t)^{t_pk_p}=1\md p$. Par la question 1), pour tout $k'\geq k_p$, on a $(a^t)^{t_pk'}=1\md p$. On a donc $j\leq k_p$. 

c) Soit $g\in (\Z/p\Z)^\times$ un générateur de $(\Z/p\Z)^\times$. Soit $x=g^{t_p2^{k_p-j}}$. Alors $x$ est d'ordre $2^j$. En effet, $x^{2^j}=1\md p$, donc l'ordre de $x$ divise $2^j$. Comme $g$ est d'ordre $t_p2^{k_p}$, $g^{t_p 2^{k_p-1}}\neq 1\md$, donc $x^{2^{j-1}}\neq 1\md p$, donc $x$ n'est pas d'ordre $2^{j-1}$ donc $x$ est d'ordre $2^j$.   Soit $\epsilon_j\in \Z$ tel que $\epsilon_j\md n= \phi^{-1}\big((x,1\md q)\big)$. Alors $\epsilon_j$ satisfait aux conditions de la question.

d) Écrivons $\phi\big((\epsilon_j\md n)^{2^{j-1}})\big)=(y\md p, 1\md q)$, pour $y\in \Z$. Alors $(y\md p, 1\md q)^2=(1\md p,1\md q)$, donc $(y\md p)^2=1\md p$. On en déduit que $y\md p\in \{1\md p,-1\md p\}$. Par choix de $\epsilon_j$, on sait que $y\md p\neq 1\md p$ (sinon on aurait que $\phi\big((\epsilon_j\md n)^{2^{j-1}}\big)=(1\md p,1\md q)$,  ce qui serait contradictoire avec le choix de $\epsilon_j$). 

e) On a $\phi\big((\epsilon_j a)^{2^{j-1}}\big)=\big((\epsilon_j\md p)^{2^{j-1}}(a_p)^{2^{j-1}},(a_q)^{2^{j-1}}\big)=(-(a_p)^{2^{j-1}},(a_q)^{2^{j-1}})=(1\md p,-1\md q)$. On a donc $(\epsilon_j a)^{2^{j-1}}\notin \{-1\md n,1\md n\}$. On a aussi $\phi\big((\epsilon_j a)^{2^{j}}\big)=\big((\epsilon_j\md p)^{2^{j}}(a_p)^{2^{j}},(a_q)^{2^{j}}\big)=\big((a_p)^{2^{j}},(a_q)^{2^{j}}\big)=(1\md p,1\md q)$, donc $(\epsilon_j a)^{2^{j}}=1\md n$, donc $\epsilon_j a\in Z_j$. 

f) Soit $a\in Y_j\setminus Z_j$, alors $\epsilon_j a \neq a$ et comme $\epsilon_j\md n\in (\Z/n\Z)^\times$, on a $\epsilon_j b\neq \epsilon_j a$ pour tous $b\neq a$. On a donc $\bigsqcup_{a\in Y_j\setminus Z_j} \{\epsilon_j a\}\subset  Z_j$, donc $|Y_j\setminus Z_j|\leq |Z_j|$ donc $|Y_j|\leq 2 |Z_j|$. Si $Y_j=Z_j$, alors $|Y_j|\leq |Z_j|$. On a donc $|Y|=\sum_{j=1}^s |Y_j|\leq \sum_{j=1}^s 2|Z_j|=2|Z|$.


Exercice~\ref{exRacines_carrées}

On a $\overline{10}^2=\overline{4.23+8}$ et $\overline{9}^2=\overline{2.31+19}$.

On peut prendre $\gamma=217\mathrm{\ mod\ }23^2$ et $\gamma=753\mathrm{\ mod\ 31^2}=-208\mathrm{\ mod\ }961$
\end{comment}



\end{document}
