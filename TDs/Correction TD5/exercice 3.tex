
\documentclass[11pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[french]{babel}
\usepackage[top=3cm, bottom=2cm, left=2cm, right=2cm]{geometry}
\usepackage{stmaryrd}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{mathrsfs}
\usepackage{amsthm}
\usepackage{layout}
\usepackage{fancyhdr}
\usepackage{comment}
\usepackage{graphicx}

\newtheorem*{thm}{Théorème}
\newtheorem{ex}{Exercice}
\newtheorem*{nota}{Notation}
\newtheorem*{rem}{Remarque}
\newtheorem*{rem2}{Remarques}
\newtheorem{de2}{Définition}
\newtheorem{pro2}[de2]{Propriété}
\newtheorem{thm2}[de2]{Théorème}

\setlength{\parindent}{0cm}
\setlength{\parskip}{1ex plus 0.5ex minus 0.2ex}
\newcommand{\hsp}{\hspace{20pt}}
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

\title{}

\date{}
\begin{document}


\pagestyle{fancy}

\fancyhead{}
 \fancyfoot{}

 \lhead{ 2020/2021 \\  L3 Mathématiques
}
\chead{\textbf{ Calcul formel}\\} 
 \rhead{  Université de Lorraine \\}

\newcommand{\lb}{\llbracket}
\newcommand{\rb}{\rrbracket}

%\newcommand{\md}[3]{#1 \equiv #2 \! \! \! \! \! \pmod {#3} }
\newcommand{\nmd}[3]{#1 \not \equiv #2 \! \! \! \! \!  \pmod #3 }
\newcommand{\mda}[3]{#1 \equiv #2 \! \!  \pmod #3 }
\newcommand{\nmda}[3]{#1 \not \equiv #2 \! \! \pmod #3 }
\newcommand{\mo}[2]{#1 \! \! \! \! \! \pmod #2 }
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\md}{\mathrm{\ mod\ }}


\thispagestyle{fancy}

\begin{center}
%    \HRule \\[0.6cm]
    { \huge \bfseries
    Feuille de TD n$^{\boldsymbol{\circ}}$5
     \\ [0cm] }
    \HRule \\[0.5cm]
\end{center}



\

Exercice 3

1. On a $2(p-1)(q-1)+1\equiv 2.1+1[3]\equiv 0[3]$ donc $2(p-1)(q-1)+1$ est divisible par $3$.

2. On a $3e-2k=1$, donc $e\wedge k=1$ et $\overline{3e}=\overline{1}$, donc $\overline{e}^{-1}=\overline{3}$.

3.a. $(2.16.10+1)/3=321/3=107$ donc $107$ correspond à $e$ pour $p=17$ et $q=11$ donc $d=3$.

3.b On a $c^d=m^{de}\equiv m[n]$. De plus, $c^d=9^3=729=4.187-19$, donc $m=187-19=168$.


\begin{comment}

\begin{ex}\label{RSA_Bruno_Catherine}\ $($Une attaque sur RSA : module commun$)$\\
Bruno et Catherine ont choisi le même module RSA $n$. Leurs exposants publics $e_B$ et $e_C$ sont distincts.
\begin{itemize}
\item[$1.$] Expliquez pourquoi Bruno peut déchiffrer les messages reçus par Catherine et réciproquement.
\item[$2.$] On suppose que $e_B$ et $e_C$ sont premiers entre eux et qu'Alice envoie les chiffrés d'un même message $m$ à Bruno et à Catherine. Expliquez comment l'attaquant Oscar peut obtenir $m$.
\item[$3.$]  Application : Bruno a la clef publique $(221,11)$ et Catherine la clef $(221,7)$ ($221=13.17$). Oscar intercepte les chiffrés $210$ et $58$ à destinations respectives de Bruno et Catherine. Retrouver le message $m$ (sans factoriser $221$).
\end{itemize} 
\end{ex}
%\


1. Pour pouvoir déchiffrer les messages codés, Bruno et Catherine ont besoin de connaître la factorisation de $n$, c'est à dire qu'il savent écrire $n=pq$ avec $p,q\in \mathbb{P¨}$. Connaissant la factorisation de $n$, ils connaissent $\varphi=(p-1)(q-1)$. Pour déchiffrer les messages de Bruno, il suffit de connaître $d_B\in \llbracket 1,\varphi\rrbracket$ tel que $d_Be_b\equiv 1 [\varphi]$. Il suffit donc d'appliquer l'algorithme d'Euclide étendu à $e_B$ et $\varphi$. Comme Catherine a accès à $e_B$ et $\varphi$ elle a accès «~rapidement~» à $d_B$ et elle peut donc déchiffrer les messages de Bruno. De même pour Bruno. On pourra utiliser que $(58\mathrm{\ mod\ }221)^3=190\mathrm{\ mod\ }221$,  $57.190-49.221=1$ et que $121.57\equiv 46[221]$.


2. On se place dans $\Z/n\Z$. L'attaquant a accès à $\overline{m}^e_B$ et à $\overline{m}^{e_C}$. Comme $e_B\wedge e_C=1$, il existe $u,v\in \Z$ tels que $ue_B=ve_C=1$. Alors $\overline{m}^{ue_B+ve_C}=(\overline{m}^{e_B})^u.(\overline{m}^{e_C})^v=\overline{m}$.

3. On a $\overline{m}^{11}=\overline{210}$ et $\overline{m}^7=\overline{58}$ donc $\overline{m}^{21}=\overline{58}^3=\overline{190}$. On en déduit que $\overline{m}=\overline{m}^{22}\overline{m}^{-21}$. De plus, $\overline{57.190}=\overline{1}$ donc $\overline{m}^{-21}=\overline{57}$ et $\overline{m}^{22}=(\overline{m}^{11})^2=\overline{-11}^2=\overline{121}$. On a donc $\overline{m}=\overline{121.57}=\overline{46}$, donc $m=46$.

\

\begin{ex}\label{attaque_exposant_petit}\ $($Une attaque sur RSA : petit exposant public commun$)$  \\
On suppose que $k$ personnes $B_1, \ldots, B_k$ ont pour exposant public RSA $e = 3$ avec des modules respectifs $n_i$, $ i \in \lb 1;k \rb $.
\begin{itemize}
\item[$1.$] Pourquoi est-il raisonnable de supposer que les $n_i$, $i \in \lb 1;k \rb$ sont deux à deux premiers entre eux?
\item[$2.$] Anne envoie les chiffrés d'un même message $m$ à tous les $B_i$. Montrer qu'un attaquant peut déterminer $m^3$ modulo $P :=\prod_{i=1}^{k} n_i$; en déduire qu'il peut calculer $m$ si $P > m^3$.


%\item[$3.$] Quelle est la valeur minimale de $k$ qui permet de toujours faire cette attaque?
\end{itemize}

\end{ex}

Exercice~\ref{attaque_exposant_petit} 

1. Les $n_i$ s'écrivent $n_i=p_iq_i$ avec $p_i,q_i\in \mathbb{P}$. Pour que les $n_i$ soient deux à deux premiers entre eux, il suffit que  tous les $p_i$ et les $q_i$ soient distincts. Comme les $p_i$ et les $q_i$ doivent être «~grands~», il est raisonnable de penser qu'ils sont tous distincts.

2. Soit $\phi:\Z/P\Z\rightarrow \Z/n_1\Z\times\ldots \times \Z/n_k\Z$ l'isomorphisme chinois. Comme l'attaquant connaît $\phi\big((m\mathrm{\ mod\ }P)^3\big)$, il peut déterminer $(m\mathrm{\ mod\ }P)^3=m^3\mathrm{\ mod\ }P$. Si $P> m^3$, l'attaquant connaît alors $m^3$. Il peut alors calculer $m$ en calculant $(m^3)^{1/3}$.




\


\begin{ex}\label{Chiffrement_Hill}\ $($Chiffrement de Hill$)$\\
Dans le chiffrement de Hill, chaque lettre de l'alphabet est représentée par un entier compris entre $0$ et $25$. L'algorithme est un chiffrement par blocs de $m$ lettres, qui transforme un bloc $(x_1, \ldots, x_m)$ en un bloc $(y_1, \ldots, y_m)$ défini par la relation suivante:
$$ (y_1, \ldots, y_m)=(x_1, \ldots, x_m).A,  $$
où $A$ est une matrice carrée d'ordre $m$ à coefficients dans $\mathbb{Z}/26 \mathbb{Z}$, tous les calculs étant faits modulo $26$. Par exemple avec $m=2$ et $ A=\begin{pmatrix}
\overline{5} & \overline{1} \\ 
\overline{12} & \overline{3}
\end{pmatrix}   $, le message $(\overline{10},\overline{21})$ est chiffré en $(\overline{10},\overline{21}).A=(\overline{10}\times \overline{5}+\overline{21}\times \overline{12},\overline{10}+\overline{21}\times \overline{3})=(\overline{16},\overline{21})$.\\
Le déchiffrement d'un bloc se fait en multipliant le bloc chiffré par la matrice inverse de $A$. Une matrice carrée à coefficients dans $\mathbb{Z}/26 \mathbb{Z}$ est inversible si et seulement si son déterminant est inversible modulo $26$.
\begin{itemize}
\item[$1.$] Quelle est la formule donnant la matrice inverse lorsque $m=2$?
\item[$2.$] Calculer la matrice inverse de celle donnée en exemple. 
\item[$3$] On suppose que l'on sait que les couples $(\overline{2} \ \ \overline{9})$ et $(\overline{11}\ \ \overline{11})$ sont envoyés sur les couples $(\overline{7}\ \ \overline{3})$ et $(\overline{11}  \ \ \overline{23}) $. Déterminer  $A$.

\end{itemize}
\end{ex}

\begin{rem}
Un défaut de chiffrer un message en le chiffrant lettres par lettres est que si l'on a accès à un message chiffré assez long, on peut regarder pour chaque lettre la fréquence à laquelle elle apparaît dans le message et la comparer avec la fréquence de cette lettre dans la langue du message. Le fait de chiffrer par blocs permet de pallier en partie ce problème.
\end{rem}
\

Exercice~\ref{Chiffrement_Hill}

1. Si $A=\begin{pmatrix}
a &b\\ c& d
\end{pmatrix}\in \mathcal{M}_2(\Z/26\Z)$ est inversible, alors la formule : $A^{-1}=\mathrm{det}(A)^{-1} {^{t\!}}\mathrm{Com}(A)$ s'écrit $A^{-1}=\mathrm{det}(A)^{-1}\begin{pmatrix}
d & -b\\ -c & a
\end{pmatrix}$.


2. $\overline{3}.\overline{9}=\overline{1}$ donc $\overline{3}^{-1}=\overline{9}$. On a donc $A^{-1}=\overline{9}\begin{pmatrix}
 \overline{3} & \overline{-12}\\ \overline{-1} & \overline{5}
\end{pmatrix}=\begin{pmatrix}
\overline{1} &  \overline{22}\\
\overline{17} & \overline{19}
\end{pmatrix}$.

3. On a $\begin{pmatrix}
\overline{2} & \overline{9}\\ \overline{7} & \overline{3}
\end{pmatrix} A=\begin{pmatrix}
\overline{7} & \overline{3}\\ \overline{11} & \overline{23}
\end{pmatrix}$. De plus, $\begin{pmatrix}
\overline{2} & \overline{9}\\ \overline{7} & \overline{3}
\end{pmatrix}$ est inversible, car sont déterminant est $-\overline{57}$ qui est inversible. Son inverse est $\overline{-5}\begin{pmatrix}
\overline{3} & \overline{-9}\\ \overline{-7} & \overline{2}
\end{pmatrix}=\begin{pmatrix}
\overline{11} & \overline{7}\\
\overline{9} & \overline{16}
\end{pmatrix}$. On a donc $A=\begin{pmatrix}
\overline{11} & \overline{7}\\
\overline{9} & \overline{16}
\end{pmatrix}
\begin{pmatrix}
\overline{2} & \overline{9}\\ \overline{7} & \overline{3}
\end{pmatrix}=\begin{pmatrix}
\overline{-5} & \overline{-10}\\ \overline{0} & \overline{-1}
\end{pmatrix}$.



\begin{ex}\label{Occurence}\   \\
Écrire un algorithme qui prend en entrée un nombre $n$ et un chiffre  $c$ et  qui calcule le nombre d'occurrences de $c$ dans l'écriture de $n$ en base $10$ (avec le nombre minimal de $0$ possibles) \\
Par exemple, le nombre d'occurrences du chiffre $2$ dans le nombre $321561262$ est $3$.  On supposera que l'on dispose d'un algorithme Ecr\_Dec qui prend en entrée un nombre $n$ et qui renvoie la liste $[a_0,\ldots,a_k]$ telle que les $a_i$ sont dans $\llbracket 0,9\rrbracket$ pour tout $i$, $a_k\neq 0$ et $n=\sum_{i=0}^k a_i 10^i$.
\end{ex}

Exercice~\ref{Occurence}

\begin{tabular}{ll}
\textbf{Algorithme} & Occurence($n,c$)\\
$L \leftarrow $Ecr\_Dec$(n)$\\
$x\leftarrow 0$\\
$\ell\leftarrow \mathrm{len}(L)$\\
pour $i$ de $0$ à $\ell$ :\\
& \ \ \ {\rm | }si $L[i]=c$ : \\
& \ \ \ \ \ \  {\rm | }$x\leftarrow x+1$\\        		
Renvoyer $x$.
\end{tabular}


\begin{ex}\label{Hanoi}$($Tours de Hanoï, voir figure$)$\ \\
Le problème des tours de Hanoï est un jeu de réflexion imaginé par le mathématicien français Édouard Lucas, et consistant à déplacer des disques de diamètres différents d'une tour source à une tour destination en passant par une tour « intermédiaire » et ceci en un minimum de coups, tout en respectant les règles suivantes :
\begin{itemize}
\item on ne peut déplacer plus d'un disque à la fois,
\item on ne peut placer un disque que sur un autre disque plus grand que lui ou sur un emplacement vide.
\end{itemize}
On suppose que cette dernière règle est également respectée dans la configuration de départ.

\begin{itemize}
\item[$1.$]  Essayer de résoudre le problème pour une tour de $1$, $2$, $3$ et $4$ palets.
\item[$2.$]  Décrire une méthode récursive pour résoudre le problèmes des tours de Hanoï.
\end{itemize}

\textit{Indication:}Résoudre le problème des tours de Hanoï, c'est-à-dire déplacer $n$ disques d'une tour source
'S' vers une tour destination 'D' en utilisant une tour intermédiaire 'I', revient à :
\begin{itemize}
\item[-] déplacer $n - 1$ disques de la tour source vers la tour intermédiaire;
\item[-] déplacer $1$ disque de la tour source vers la tour destination;
\item[-] déplacer $n - 1$ disques de la tour intermédiaire vers la tour destination.
\end{itemize}

\end{ex}


Exercice~\ref{Hanoi}

Soit $n\in \N^*$. Supposons que l'on sache déplacer une tour à $n$ disques  d'un bâton à un autre. On considère une tour à $n+1$ disques placés sur $A$. On envoie d'abord les $n$ premiers disques sur $C$. On envoie le plus gros disque sur $B$ puis on déplace les $n$ disques de $C$ sur $B$. On a donc déplacé les $n+1$ disques de $A$ à $B$.


\centering\includegraphics[scale=1]{hanoi.png}
\

\end{comment}


\end{document}
