
\documentclass[11pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[french]{babel}
\usepackage[top=3cm, bottom=2cm, left=2cm, right=2cm]{geometry}
\usepackage{stmaryrd}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{mathrsfs}
\usepackage{amsthm}
\usepackage{layout}
\usepackage{fancyhdr}
\usepackage{comment}

\newtheorem*{thm}{Théorème}
\newtheorem{ex}{Exercice}
\newtheorem*{nota}{Notation}
\newtheorem*{rem}{Remarque}
\newtheorem*{rem2}{Remarques}
\newtheorem{de2}{Définition}
\newtheorem{pro2}[de2]{Propriété}
\newtheorem{thm2}[de2]{Théorème}

\setlength{\parindent}{0cm}
\setlength{\parskip}{1ex plus 0.5ex minus 0.2ex}
\newcommand{\hsp}{\hspace{20pt}}
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

\title{}

\date{}
\begin{document}


\pagestyle{fancy}

\fancyhead{}
 \fancyfoot{}

 \lhead{ 2020/2021 \\  L3 Mathématiques
}
\chead{\textbf{ Calcul formel}\\} 
 \rhead{  Université de Lorraine \\}

\newcommand{\lb}{\llbracket}
\newcommand{\rb}{\rrbracket}

%\newcommand{\md}[3]{#1 \equiv #2 \! \! \! \! \! \pmod {#3} }
\newcommand{\nmd}[3]{#1 \not \equiv #2 \! \! \! \! \!  \pmod #3 }
\newcommand{\mda}[3]{#1 \equiv #2 \! \!  \pmod #3 }
\newcommand{\nmda}[3]{#1 \not \equiv #2 \! \! \pmod #3 }
\newcommand{\mo}[2]{#1 \! \! \! \! \! \pmod #2 }
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\md}{\mathrm{\ mod\ }}


\thispagestyle{fancy}

\begin{center}
%    \HRule \\[0.6cm]
    { \huge \bfseries
Correction
     \\ [0cm] }
    \HRule \\[0.5cm]
\end{center}




Exercice~3

\
1) Soit $\phi:\Z/15\Z\rightarrow \Z/3\Z\times \Z/5\Z$ l'isomorphisme chinois. Soit $a\in \Z$ tel que $a^{14}\equiv 1[15]$. Alors $\phi(\overline{a})^{14}=(\overline{1},\overline{1})$, c'est à dire $(a\mathrm{\ mod\ } 3)^{14}=1\mathrm{\ mod\ }3$ et $(a\mathrm{\ mod\ }5)^{14}=1\mathrm{\ mod\ }5$. On a $(0\mathrm{\ mod\ }3)^{14}=0\mathrm{\ mod\ }3\neq 1\mathrm{\ mod\ }3$, $(1\mathrm{\ mod\ }3)^{14}=1\mathrm{\ mod\ }3$ et $(-1\mathrm{\ mod\ }3)^{14}=1\mathrm{\ mod\ } 3$. 

On a $\varphi(5)=4$, donc l'ordre de tout élément de $(\Z/5\Z)^\times$ divise $4$. Ainsi, si $x\in \Z\setminus 5\Z$, $(x\mathrm{\ mod\ }5)^{14}=(x\mathrm{\ mod\ }5)^{3.4+2}=(x\mathrm{\ mod\ }5)^2$. On cherche donc les $x\mathrm{\ mod\ }5\in (\Z/5\Z)^\times$ tels que $(x\mathrm{\ mod\ }5)^2=1\mathrm{\ mod\ }5$. On obtient $1\mathrm{\ mod\ }5$ et $4\mathrm{\ mod\ }5$. Donc \[\{\overline{x}\in \Z/15\Z|\ \overline{x}^{14}=\overline{1}\}=\{\phi^{-1}\big((\overline{1},\overline{1})\big),\phi^{-1}\big((\overline{1},\overline{4})\big),\phi^{-1}\big((\overline{2},\overline{1})\big),\phi^{-1}\big((\overline{2},\overline{4})\big)\}.\] On a $-3.3+2.5=1$, donc $\phi(\overline{10})=(\overline{1},\overline{0})$ et $\phi(\overline{-9})=(\overline{0},\overline{1})$ donc $\phi^{-1}\big((\overline{1},\overline{0})\big)=\overline{10}$ et $\phi^{-1}\big((\overline{0},\overline{1}\big)=\overline{-9}=\overline{6}$. On a donc $\{\phi^{-1}\big((\overline{1},\overline{1})\big),\phi^{-1}\big((\overline{1},\overline{4})\big),\phi^{-1}\big((\overline{2},\overline{1})\big),\phi^{-1}\big((\overline{2},\overline{4})\big)\}=\{\overline{1},\overline{4},\overline{11},\overline{14}\}$. Le nombre $15$ est donc pseudo-premier de base $a$ si et seulement si $a\mathrm{\ mod\ }15\in \{1\mathrm{\ mod\ }15,4\mathrm{\ mod\ }15, 11\mathrm{\ mod\ }15, 14\mathrm{\ mod\ }15\}$.


2) On a $(13\md 3)^{104}=(1\md 3)^{104}=1\md 3$, $(13\md 5)^{104}=(3\md 5)^{104}=((3\md 5))^2)^{52}=(-1\md 5)^{52}=1\md 5$ et $(13\md 7)^{104}=(-1\md 7)^{104}=1\md 104$. Soit $\phi:\Z/105\Z\rightarrow \Z/3\Z\times \Z/5\Z\times \Z/7\Z$ l'isomorphisme chinois. Alors $\phi(\overline{13})^{104}=(13\md 3,13\md 5,13\md 7)^{104}=(1\md 3,1 \md 5,1 \md 7)$ donc $\overline{13}^{104}=\overline{1}$ dans $\Z/105\Z$, donc $105$ est pseudo-premier de base $13$.

On a $\varphi(7)=6$, donc l'ordre de $\overline{2}$ dans $(\Z/7Z)^\times$ divise $6$, donc $\overline{2}^{104}=\overline{2}^{6.17+2}=\overline{1}^{17}.\overline{2}^{2}=\overline{4}\neq \overline{1}$. On a donc $\phi(\overline{2})^{104}=\big((2\md 3)^{104}, (2\md 5)^{104},4\md 7)\neq (1\md 3, 1\md 5, 1\md 7)$ donc $(2\md 105)^{104}\neq 1\md  105$, donc $105$ n'est pas pseudo-premier de base $2$.

3) Écrivons la décomposition de $n$ en produit de facteurs premiers $n=p_1^{\alpha_1}\ldots p_k^{\alpha_k}$, où les $p_i$ sont des nombres premiers distincts et $\alpha_1,\ldots,\alpha_k\in \N^*$. Soit $\phi:\Z/n\Z\rightarrow \Z/p_1^{\alpha_1}\Z\times \ldots \times \Z/p_k^{\alpha_k}\Z$ l'isomorphisme chinois. On doit trouver l'ensemble $E=\{a\in \Z|a^{n-1}\equiv 1[n]\}$. On a $\phi(E)=\{(x_1,\ldots,x_k)\in \Z/n\Z\rightarrow \Z/p_1^{\alpha_1}\Z\times \ldots \times \Z/p_k^{\alpha_k}\Z|(x_1^{n-1},\ldots,x_k^{n-1})=(\overline{1},\ldots,\overline{1})\}$. Pour déterminer $E$, on peut donc déterminer $E_i:=\{x\in \Z/p_i^{\alpha_i}\Z|\ x^{n-1}=\overline{1}\}$ pour tout $i\in \llbracket 1,k\rrbracket$ puis déterminer $\phi^{-1}(E_1\times \ldots \times E_k)$. Soient $i\in\llbracket 1,k\rrbracket$ et $x\in \Z/p_i^{\alpha_i}\Z$. Alors si $x\in E_i$, $x$ est inversible dans $\Z/p_i^{\alpha_i}\Z$ (car $x.x^{n-2}=\overline{1}$).  Par le théorème d'Euler, $x^{\varphi(p_i^{\alpha_i})}=\overline{1}$.  De plus, $\varphi(p_i^{\alpha_i})=p_i^{\alpha_i}(1-\frac{1}{p_i})<p_i^{\alpha_i}<n-1$. On peut donc déterminer le reste  $r_i$ de la division euclidienne de $n-1$ par $\varphi(p_i^{\alpha_i})$. Alors $E_i=\{x\in (\Z/p_i^{\alpha_i}\Z)^\times |x^{r_i}=\overline{1}\}$. On peut alors déterminer $E_i$ en essayant tous les éléments de $\Z/p_i^{\alpha_i}\Z$.


\begin{comment}
Exercice~\ref{calculs_symboles_legendre}

D'après la loi de réciprocité quadratique, $\left( \frac{7}{17} \right)=(-1)^{\frac{7-1}{2}.\frac{17-1}{2}}(\frac{17}{7})=(\frac{17}{7})$. Par définition, $(\frac{17}{7})=(\frac{17\md 7}{7})=(\frac{3}{7})$. Par la loi de réciprocité quadratique, $(\frac{3}{7})=(-1)^{\frac{7-1}{2}.\frac{3-1}{2}}(\frac{7}{3})=-(\frac{7}{3})=-(\frac{7\md 3}{3})=-(\frac{1}{3})=-1$.

On a $(\frac{28}{13})=(\frac{28\md 13}{13})=(\frac{15}{13})=(\frac{2}{13})=(-1)^{(169-1)/8}=(-1)^{21}=-1$.

On a $(\frac{10}{83})=(\frac{2}{83}).(\frac{5}{83})$. On a $(\frac{2}{83})=(-1)^{\frac{83^2-1}{8}}$. On s'intéresse à la parité de $(83^2-1)/8$. Soit $x\in\Z$. Alors $\frac{x-1}{8}$ est pair ssi $\frac{x-1}{8}=2k$ pour $k\in \Z$ ssi $x=16k+1$, pour $k\in \Z$. Le nombre  $\frac{x-1}{8}$ est impair ssi $\frac{x-1}{8}=2k+1$ pour $k\in\Z$ ssi $x-1=16k+8$ ssi $x=16k+9$, pour $k\in \Z$. On a $83=5.16+3\equiv 3[16]$ donc $(83)^2\equiv 9 [16]$ donc $(83^2-1)/8$ est impair donc $(\frac{2}{83})=-1$. On a $(\frac{5}{83})=(-1)^{(5-1)/2}.(-1)^{(83-1)/2}(\frac{83}{5})=(-1)(\frac{83}{5})=(-1)(\frac{83\md 5}{5})=-(\frac{3}{5})$. On a $(\frac{3}{5})=(-1)^{(3-1)/2}(-1)^{(5-1)/2}(\frac{5}{3})=(-1)(\frac{2}{3})=(-1).(-1)^{(9-1)/8}=1$. On a donc $(\frac{10}{83})=1$.

On a $(\frac{665}{97})=(\frac{133}{97})(\frac{5}{97})=(\frac{133\md 97}{97})(\frac{5}{97})$. De plus, $(\frac{133\md 97}{97})=(\frac{36}{97})=(\frac{6}{97})^2=1$, car $(\frac{6}{97})\in \{-1,1\}$. On a $(\frac{5}{97})=(-1)^{(5-1)/2}(-1)^{(97-1)/2}(\frac{97}{5})=(\frac{97}{5})=(\frac{2}{5})=(-1)^{(5^2-1)/8}=(-1)$. On a donc $(\frac{665}{97})=-1$.


Exercice~\ref{algorithme_legendre}

\begin{tabular}{ll}
\textbf{Algorithme} & Legendre($a,p$)\\
           & si $a=2$\\
                      & \ \ \ {\rm | }renvoyer $(-1)^{(p^2-1)/8}$,\\
           & si $a\geq p$ ou $a\leq 0$,\\
                     & \ \ \ {\rm | }renvoyer Legendre$(a\md p,p)$,\\           
           & si $a\geq 0$ et $a\leq p-1$\\
                      & \ \ \ {\rm | }$X\leftarrow$ factorisation$(a)$ \\
                      & \ \ \ {\rm | }$P\leftarrow X[0]$ \\     
                      & \ \ \ {\rm | }$A\leftarrow X[1]$ \\
                      & \ \ \ {\rm | }renvoyer $\prod_{i\in \llbracket 0,\mathrm{len}(P)\rrbracket|A[i]\%2==1}\text{Legendre}(P[i],p)$,\\
           & si Isprime(a)==True\\
                      & \ \ \ {\rm | }renvoyer $(-1)^{\frac{a-1}{2}}(-1)^{\frac{(p-1)}{2}}\text{Legendre}(p,a)$\\           
\end{tabular}

Exercice~\ref{eq_second_degré}


1) Si $\alpha=0$, alors la seule racine carrée de $\overline{0}$ dans $\Z/p\Z$ est $\overline{0}$. De plus $1+(\frac{0}{p})=1$, donc la formule donnée est valable pour $\alpha=0$.

Supposons que $\alpha$ n'admette pas de racine carrée dans $\Z/p\Z$. Alors $\alpha$ n'est pas un carré dans $\Z/p\Z$, donc $(\frac{\alpha}{p})=-1$ et $1+(\frac{\alpha}{p})=0$.

Soient $A$ un anneau commutatif et  $x,y\in A$. Alors $(x-y)(x+y)=x^2-xy+yx-y^2=x^2-y^2$.

Supposons que $\overline{\alpha}$ est un carré non nul de $\Z/p\Z$. Alors il existe $\overline{\beta}\in \Z/p\Z$ tel que $\overline{\beta}^2=\overline{\alpha}$. Soit $x\in \Z/p\Z$. Alors $x^2=\overline{\alpha}$ si et seulement si $x^2-\overline{\beta}^2=0$. De plus, $(x-\overline{\beta})(x+\overline{\beta})=x^2-\overline{\beta}^2$ donc $x^2-\overline{\beta}^2=0$ si et seulement si $(x-\overline{\beta})(x+\overline{\beta})=\overline{0}$ (car $\Z/p\Z$ est intègre) si et seulement si $x\in \{-\overline{\beta},\overline{\beta}\}$. Alors $\overline{\alpha}$ admet exactement $2=1+(\frac{\alpha}{p})$ racines carrées dans $\Z/p\Z$.

2) Comme $a$ est inversible $x$ est solution de (E) si et seulement si $x^2+\frac{b}{a}x+\frac{c}{a}=0$. On a $(x+\frac{b}{2a})^2=x^2+2\frac{b}{2a}x+\frac{b^2}{4a^2}=x^2+\frac{b}{a}x+\frac{b^2}{4a^2}$. Soit $x\in \Z/p\Z$. Alors $x$ est solution de (E) si et seulement si $x^2+\frac{b}{a}x+\frac{c}{a}=0$ si et seulement si $(x+\frac{b}{2a})^2-\frac{b^2}{4a^2}+\frac{c}{a}=(x+\frac{b}{2a})^2+\frac{4ac-b^2}{4a^2}=0$ si et seulement si $(x+\frac{b}{2a})^2=\frac{b^2-4ac}{4a^2}$. Cette équation admet une solution si et seulement si $\frac{b^2-4ac}{4a^2}$ est un carré. Soit $y\in \Z/p\Z$. Alors $y^2=\frac{b^2-4ac}{4a^2}$ si et seulement si $(2ay)^2=b^2-4ac$ donc $\frac{b^2-4ac}{4a^2}$ est un carré si et seulement si $b^2-4ac$ est un carré. Si $b^2-4ac$ est un carré, les racines carrées de $\frac{b^2-4ac}{4a^2}$ sont exactement les $\frac{y}{2a}$ tels que $y$ est une racine carrée de $b^2-4ac$, d'où le résultat.

3) On a $\Delta_a=-4$, donc $(\frac{\Delta_a}{83})=(\frac{-4}{83})=(\frac{-1}{83})(\frac{4}{83})=(-1)^{41}.(\frac{2}{83})^2=-1$ $\leadsto$ $0$ solution.

On a $\Delta_b=-3$, donc $(\frac{\Delta_b}{83})=(\frac{-1}{83})(\frac{3}{83})=-(\frac{3}{83})$. On a $(\frac{3}{83})=(-1)^{(3-1)/2}(-1)^{(83-1)/2}(\frac{83}{3})=-(\frac{83}{3})=-(\frac{2}{3})=-(-1)^{(9-1)/8}=1$. On a donc$(\frac{\Delta_b}{83})=-1$ $\leadsto$ $0$ solution.


On a $\Delta_c=16-4.13=-36$ donc $(\frac{\Delta_b}{83})=(\frac{-1}{83})(\frac{6}{83})^2=(\frac{-1}{83})=-1$ $\leadsto 0$ solution.

On  a $\Delta_d=1-4.21=-83$ donc $(\frac{\Delta_d}{83})=(\frac{-83}{83})=0$ $\leadsto$ 1 solution.

On a $\Delta_e=9^2-4.3=69$ donc $(\frac{\Delta_e}{83})=(\frac{69}{83})=(\frac{23}{83})(\frac{3}{83})=(\frac{23}{83})$ (car on a déjà calculé $(\frac{3}{83})=1$). On  a $(\frac{23}{83})=(-1)^{11}(-1)^{41}(\frac{83}{23})=(\frac{14}{23})=(\frac{2}{23})(\frac{7}{23})$. On a $23\equiv 7[16]$ donc $23^2\equiv 49[16]\equiv 1[16]$ donc $(-1)^{(23^2-1)/8}=1$. On a $(\frac{7}{23})=(\frac{23}{7})=(\frac{2}{7})=(-1)^{48/8}=1$. On a donc $(\frac{\Delta_e}{83})=1$ donc il y a $2$ solutions.

Exercice~\ref{legendre_p+1_p} 

On a $(\frac{\frac{p+1}{2}}{p})(\frac{2}{p})=(\frac{p+1}{p})=(\frac{1}{p})=1$ donc $(\frac{\frac{p+1}{2}}{p})=(\frac{2}{p})^{-1}=(\frac{2}{p})=(-1)^{(p^2-1)/8}$.




Exercice~\ref{securite_RSA}

1) On a $(a^{2^{j}t})^2=a^{2.2^jt}=a^{2^{j+1}t}=\overline{1}$.

2) Soit $a\in Y$. Soit $E(a)=\{j'\in \llbracket 1,s\rrbracket| a^{2^{j'}t}=\overline{1}\}$. Écrivons $ed-1=k\varphi$, avec $k\in\N^*$. Alors par le petit théorème de Fermat, $a^{k\varphi}=\overline{1}$, donc $a^{2^st}=\overline{1}$, donc $s\in E(a)$. Soit $j=\min E(a)$. Alors par définition, $a\in Y_j$. Par la question 1), $E(a)=\llbracket j,s\rrbracket$. On en déduit que si $a\in Y_{j'}$ pour $j'\in \llbracket 1,s\rrbracket$, alors $j'=j$. On a donc $Y=\bigsqcup_{j=1}^s Y_j$. Soit $a\in Z$. Par définition de $Z$, on a $Z=\bigcup_{j=1}^s Z_j$. De plus, si $j\in \llbracket 1,s\rrbracket$, on a $Z_j\subset Y_j$, donc l'union est disjointe : $Z=\bigsqcup_{j=1}^s Z_j$.


3)a) Comme $Z_j\subset Y_j$, on a $Z_j\subsetneq Y_j$. Soit $a\in Y_j\setminus Z_j$, alors $a^{2^{j-1}t}\in \{\overline{-1},\overline{1}\}$ et $a^{2^{j-1}t}\neq \overline{1}$, donc $a^{2^{j-1}t}=\overline{-1}$.

b) Soit $\phi:\Z/n\Z\rightarrow \Z/p\Z\times \Z/q\Z$ l'isomorphisme chinois. Écrivons $\phi(a)=(a_p,a_q)$. Alors $(a_p)^{2^j t}=-1\md p$ et $(a_q)^{2^jt}=-1\md q$. On a $(a_p)^{2^jtt_p}=(-1\md p)^{t_p}=-1\md p$. Par le petit théorème chinois, $(a^{tt_p})^{2^{k_p}}=(a^t)^{t_pk_p}=1\md p$. Par la question 1), pour tout $k'\geq k_p$, on a $(a^t)^{t_pk'}=1\md p$. On a donc $j\leq k_p$. 

c) Soit $g\in (\Z/p\Z)^\times$ un générateur de $(\Z/p\Z)^\times$. Soit $x=g^{t_p2^{k_p-j}}$. Alors $x$ est d'ordre $2^j$. En effet, $x^{2^j}=1\md p$, donc l'ordre de $x$ divise $2^j$. Comme $g$ est d'ordre $t_p2^{k_p}$, $g^{t_p 2^{k_p-1}}\neq 1\md$, donc $x^{2^{j-1}}\neq 1\md p$, donc $x$ n'est pas d'ordre $2^{j-1}$ donc $x$ est d'ordre $2^j$.   Soit $\epsilon_j\in \Z$ tel que $\epsilon_j\md n= \phi^{-1}\big((x,1\md q)\big)$. Alors $\epsilon_j$ satisfait aux conditions de la question.

d) Écrivons $\phi\big((\epsilon_j\md n)^{2^{j-1}})\big)=(y\md p, 1\md q)$, pour $y\in \Z$. Alors $(y\md p, 1\md q)^2=(1\md p,1\md q)$, donc $(y\md p)^2=1\md p$. On en déduit que $y\md p\in \{1\md p,-1\md p\}$. Par choix de $\epsilon_j$, on sait que $y\md p\neq 1\md p$ (sinon on aurait que $\phi\big((\epsilon_j\md n)^{2^{j-1}}\big)=(1\md p,1\md q)$,  ce qui serait contradictoire avec le choix de $\epsilon_j$). 

e) On a $\phi\big((\epsilon_j a)^{2^{j-1}}\big)=\big((\epsilon_j\md p)^{2^{j-1}}(a_p)^{2^{j-1}},(a_q)^{2^{j-1}}\big)=(-(a_p)^{2^{j-1}},(a_q)^{2^{j-1}})=(1\md p,-1\md q)$. On a donc $(\epsilon_j a)^{2^{j-1}}\notin \{-1\md n,1\md n\}$. On a aussi $\phi\big((\epsilon_j a)^{2^{j}}\big)=\big((\epsilon_j\md p)^{2^{j}}(a_p)^{2^{j}},(a_q)^{2^{j}}\big)=\big((a_p)^{2^{j}},(a_q)^{2^{j}}\big)=(1\md p,1\md q)$, donc $(\epsilon_j a)^{2^{j}}=1\md n$, donc $\epsilon_j a\in Z_j$. 

f) Soit $a\in Y_j\setminus Z_j$, alors $\epsilon_j a \neq a$ et comme $\epsilon_j\md n\in (\Z/n\Z)^\times$, on a $\epsilon_j b\neq \epsilon_j a$ pour tous $b\neq a$. On a donc $\bigsqcup_{a\in Y_j\setminus Z_j} \{\epsilon_j a\}\subset  Z_j$, donc $|Y_j\setminus Z_j|\leq |Z_j|$ donc $|Y_j|\leq 2 |Z_j|$. Si $Y_j=Z_j$, alors $|Y_j|\leq |Z_j|$. On a donc $|Y|=\sum_{j=1}^s |Y_j|\leq \sum_{j=1}^s 2|Z_j|=2|Z|$.
\end{comment}


\end{document}
